# LINQ
* LINQ -> Language Integrated Query
* bagian dari bahasa C# yang memungkinkan Anda menulis kueri terhadap berbagai sumber data, termasuk koleksi objek, database, XML, dan lainnya, menggunakan sintaksis yang mirip dengan SQL. 
* LINQ menyediakan cara yang konsisten untuk melakukan operasi pencarian, penyaringan, pengurutan, dan transformasi data tanpa perlu menulis banyak kode.

--------------------------
> Program.cs

```csharp
using System;
using System.Linq;
using System.Xml.Linq;

namespace csharpfeat03
{
    public class Program
    {
        static void Main(string[] args)
        {
            // Language Integrated Query (LINQ)
            string[] dogs = { "K 9", "Brian Griffin", "Scooby Doo", "Old Yeller", "Rin Tin Tin", "Benji", "Charlie B. Barkin", "Lassie", "Snoopy" };

            var dogSpaces = from dog in dogs
                            where dog.Contains(" ")
                            orderby dog descending
                            select dog;

            foreach (var i in dogSpaces) Console.WriteLine(i);
        }
    }
}
```

Hasil:
```terminal
Scooby Doo
Rin Tin Tin
Old Yeller
K 9
Charlie B. Barkin
Brian Griffin
```

----------------

> Program.cs
```csharp
using System;
using System.Linq;
using System.Xml.Linq;

namespace csharpfeat03
{
    public class Program
    {

        static int[] QueryIntArray()
        {
            int[] nums = {5, 10, 15, 20, 25, 30, 35};

            var gt20 = from num in nums
                       where num > 20
                       orderby num
                       select num;

            foreach(int num in gt20) Console.WriteLine(num);

            Console.WriteLine($"Get Type: {gt20.GetType()}");

            Console.WriteLine();

            var listGT20 = gt20.ToList<int>();
            var arrayGT20 = gt20.ToArray();

            nums[0] = 40;
            foreach (int num in gt20) Console.WriteLine(num);

            Console.WriteLine() ;

            return arrayGT20;
        }

        static void Main(string[] args)
        {
            int[] intArray = QueryIntArray();

            foreach (int num in intArray) Console.WriteLine(num);
        }
    }
}
```


Hasil: 
```terminal
25
30
35
Get Type: System.Linq.OrderedEnumerable`2[System.Int32,System.Int32]

25
30
35
40

25
30
35
```

* After you change nums[0] to 40, gt20 still contains the same values (25, 30, 35) because the query is not re-executed immediately. The query is re-evaluated when you iterate over gt20 again.
* When you iterate over gt20 the second time, the query is re-evaluated based on the current state of nums, which now includes 40 at index 0. So, the result includes 40 as well (25, 30, 35, 40).

-------------------------

> Animal.cs
```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace csharpfeat03
{
    class Animal
    {
        public string Name {  get; set; }
        public double Weight { get; set; }
        public double Height { get; set; }
        public int AnimalID {  get; set; }

        public Animal(string name = "No Name",
            double weight=0,
            double height=0)
        {
            Name = name;
            Weight = weight;
            Height = height;
        }

        public override string ToString() 
        {
            return string.Format("{0} weights {1}lbs and is {2} inches tall",
                Name, Weight, Height);
        }
    }
}

```

> Owner.cs
```csharp
namespace csharpfeat03
{
    class Owner
    {
        public string Name { get; set; }
        public int OwnerID {  get; set; }
    }
}
```

* `OfType` adalah metode ekstensi LINQ yang digunakan untuk memfilter elemen dalam koleksi berdasarkan tipe yang ditentukan. 
* Ini berarti `OfType` akan mengembalikan hanya elemen-elemen dalam koleksi yang merupakan instance dari tipe yang ditentukan, dan akan mengabaikan elemen-elemen lainnya.

> Program.cs
```csharp
using System;
using System.Linq;
using System.Xml.Linq;
using System.Collections;

namespace csharpfeat03
{
    public class Program
    {
        static void Main(string[] args)
        {
            ArrayList famAnimals = new ArrayList()
            {
                new Animal {Name="Heidi", Height= .8, Weight=18},
                new Animal {Name="Shrek", Height=4, Weight=130},
                new Animal {Name="Congo", Height=3.8, Weight=90}
            };

            var famAnimalEnum = famAnimals.OfType<Animal>();

            var smAnimals = from animal in famAnimalEnum
                            where animal.Weight <= 90
                            orderby animal.Name
                            select animal;
            
            foreach(var animal in smAnimals ) Console.WriteLine("{0} weights {1}lbs", animal.Name, animal.Weight);
        }
    }
}
```

Hasil:
```terminal
Congo weights 90lbs
Heidi weights 18lbs
```

--------------------

> Program.cs
```csharp
using System;
using System.Linq;
using System.Xml.Linq;
using System.Collections;

namespace csharpfeat03
{
    public class Program
    {
        static void Main(string[] args)
        {
            ArrayList animalList = new ArrayList()
            {
                new Animal {Name="German Shephard", Height= 25, Weight=77},
                new Animal {Name="Chihuahua", Height=7, Weight=4.4},
                new Animal {Name="Saint Bernard", Height=30, Weight=200}
            };

            var animalListEnum = animalList.OfType<Animal>();

            var bigDogs = from dog in animalListEnum
                          where (dog.Weight > 70) &&
                          (dog.Height > 25)
                          orderby dog.Name
                          select dog;

            
            
            foreach(var animal in bigDogs ) Console.WriteLine("{0} weights {1}lbs", animal.Name, animal.Weight);
        }
    }
}
```

Hasil: `Saint Bernard weights 200lbs`

---------------------------------------------











[<- back](https://github.com/QuackPlayground/csharp/blob/main/theory/basic/33.md)
[continue ->](https://github.com/QuackPlayground/csharp/blob/main/theory/basic/35.md)